<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <title>2D AR éŠæˆ² + æ˜Ÿå…‰å¤§é“ Demo</title>
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.css" />
  <style>
    body, html { margin:0; padding:0; height:100%; overflow:hidden; font-family:sans-serif; background:black; }
    #home-btn { position:fixed; top:15px; left:15px; background:rgba(0,0,0,0.6); color:white; border:none; border-radius:50%; width:50px; height:50px; font-size:22px; cursor:pointer; z-index:9999; }

    /* éŠæˆ²å€ & æ˜Ÿå…‰å¤§é“ */
    #game-container { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); z-index:10; display:none; text-align:center; color:white; }
    #star-name { font-size:22px; margin-top:12px; }
    #generate-btn { margin-top:8px; padding:6px 12px; border:none; border-radius:6px; background:#0078ff; color:white; cursor:pointer; }

    /* å½ˆå¹• */
    #barrage-container { position:absolute; top:0; left:0; width:100%; height:50%; pointer-events:none; z-index:15; overflow:hidden; display:none; }
    .barrage { position:absolute; white-space:nowrap; font-size:18px; color:white; text-shadow:0 0 6px black; display:flex; align-items:center; gap:6px; animation: moveLeft 8s linear forwards; }
    @keyframes moveLeft { from { left:100%; } to { left:-100%; } }

    /* ç•™è¨€å€ */
    #messageForm { position:fixed; bottom:10px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,0.95); padding:8px 12px; border-radius:12px; display:flex; align-items:center; gap:8px; width:90%; max-width:900px; justify-content:space-between; z-index:1000; display:none; }
    #messageInput { flex:1; padding:6px 8px; border-radius:6px; border:1px solid #ccc; }
    #sendButton { background-color:#0078ff; color:white; border:none; border-radius:6px; padding:6px 12px; cursor:pointer; }
    #sendButton:hover { background-color:#005fcc; }
  </style>
</head>
<body>

<button id="home-btn" onclick="goHome()">ğŸ </button>

<!-- éŠæˆ² + æ˜Ÿå…‰å¤§é“ -->
<div id="game-container">
  <div>æ­¡è¿ä¾†åˆ° AR æ˜Ÿå…‰å¤§é“ ğŸ‰</div>
  <input type="text" id="nameInput" placeholder="è¼¸å…¥ä½ å€‹å"/>
  <div id="star-name"></div>
  <button id="generate-btn">ç”Ÿæˆæ˜Ÿå…‰å¤§é“åå­—</button>
</div>

<!-- å½ˆå¹•å®¹å™¨ -->
<div id="barrage-container"></div>

<!-- ç•™è¨€å€ -->
<div id="messageForm">
  <input type="text" id="messageInput" placeholder="è¼¸å…¥æ–‡å­—..." />
  <button id="sendButton">ç™¼é€</button>
</div>

<!-- AR Scene -->
<a-scene mindar-image="imageTargetSrc: travel-target.mind; autoStart: true; filterMinCF: 0.0001; filterBeta: 0.001; missTolerance: 5; warmupTolerance: 5" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: true" embedded>
  <a-camera position="0 0 0" look-controls="enabled:false"></a-camera>

  <!-- Marker -->
  <a-entity mindar-image-target="targetIndex:0" id="marker-demo">
    <a-plane color="#222" height="1" width="1" position="0 0 0.1"></a-plane>
  </a-entity>
</a-scene>

<script>
function goHome() {
  window.location.href = "https://starlightar.webflow.io/";
}

// ======== å½ˆå¹•ç³»çµ± ========
const container = document.getElementById("barrage-container");
const messageForm = document.getElementById("messageForm");
const messageInput = document.getElementById("messageInput");
const sendButton = document.getElementById("sendButton");

let messages = [];
function showBarrage(msg){
  const el = document.createElement("div");
  el.className = "barrage";
  el.style.top = Math.random()*(container.offsetHeight-30)+"px";
  el.textContent = msg;
  container.appendChild(el);
  setTimeout(()=>el.remove(),9000);
}

// ç™¼é€ç•™è¨€
sendButton.addEventListener("click", ()=>{
  const text = messageInput.value.trim();
  if(!text) return;
  messages.push(text);
  showBarrage(text);
  messageInput.value="";
});

// Enter ç™¼é€
messageInput.addEventListener("keydown", e=>{ if(e.key==="Enter") sendButton.click(); });

// ======== Marker æ‰¾åˆ° / æ¶ˆå¤±äº‹ä»¶ ========
const gameContainer = document.getElementById("game-container");
const starNameDiv = document.getElementById("star-name");
const nameInput = document.getElementById("nameInput");
const generateBtn = document.getElementById("generate-btn");

const marker = document.getElementById("marker-demo");

marker.addEventListener("targetFound", ()=>{
  container.style.display="block";
  messageForm.style.display="flex";
  gameContainer.style.display="block";
});

marker.addEventListener("targetLost", ()=>{
  container.style.display="none";
  messageForm.style.display="none";
  gameContainer.style.display="none";
});

// ç”Ÿæˆæ˜Ÿå…‰å¤§é“åå­—
generateBtn.addEventListener("click", ()=>{
  const name = nameInput.value.trim();
  if(!name) return;
  starNameDiv.textContent = `â­ ${name} â­`;
});
</script>

</body>
</html>
